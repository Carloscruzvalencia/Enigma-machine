document.addEventListener('keydown', (event) => {
    // variable that contains the value of the key pressed by the user
    var letter = event.key;

    // Array of 27 letters the original enigma machine dont use the character ñ but i added so i use 27 characters instead of 26 characters
    letterArray = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'ñ', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
    letterArray2 = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'Ñ', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    // the conversion of (event.key) to lowerCase fails (and i dont know how to do it) so i compare the position of letter in both arrays
    
    // this variable contains the position of the letter in lowercase
    lettPos = letterArray.indexOf(letter)
    // this variable contains the position of the letter in uppercase
    lettPos2 = letterArray2.indexOf(letter)

    // this condition selects only the positive number of both variables (if the user enters a lowerCase leter the upperCase is negative = -1 so the correct answer is the one that get the positive value and also is the current position of the lowerCase/uppercase)
    // also if the value is not a character the utput is -1 so is not a letter or is not the letter expected
    if (lettPos >= 0) {
        position = lettPos
        lettType = "loWercase"
    } else {
        position = lettPos2
        lettType = "upperCase"
    }

    // ----------------------------- First encryption phase the plug -------------------------------------

    // variable that tells if the user wants to use a personalized plugboard or arandom plugboard
    plugUse = 0
    // array containing the letters that have changed by the plug
    plug = []
    // array containing the letters that have changed by the user 
    userchange = [];

    //this variable generates a new number betwen 0 and 27
    letterplug = Math.floor(Math.random() * 27);

    plug.push(letterplug)

    if (lettType == 'loWercase'){
        // this variable contains the new letter selectet by the random if is loWerCase
        lettindex = letterArray[letterplug]
    }else{
        // this variable contains the new letter selectet by the random if is UpperCase
        lettindex = letterArray2[letterplug]
    }

    document.getElementById("plugData").onclick = function () {
        for (i = 0, j = 27; i != j; i++) {
            ch = document.getElementById("letter-" + [i]).value;

            if (ch == letterArray[i]) {
                userchange.push(ch)
            } else {
                if (ch == ""){
                    userchange.push(letterArray[i])
                }else{
                    userchange.push(ch)
                    console.error("la letra "+letterArray[i]+" a hora es "+userchange[i])
                }
            }
        }
        console.log(userchange)
    }
    // ----------------------------- End of first phase of encryption ------------------------------------

    // ------------------------------- DATA LOGS ---------------------------------------------------------
    // table for letters and is key number reference and the type of letter
    function conData(UserLetter, keyNumber, type) {
        this.UserLetter = UserLetter;
        this.keyNumber = keyNumber;
        this.type = type;
    }
    var rawData = new conData(letter, position, lettType);
    console.warn("rawDATA / user input")
    console.table([rawData]);

    // table showing the letter added by the user and the new letter generated by the plug
    function plugData(currentLetter, plugOut,newPlugLetter) {
        this.currentLetter = currentLetter;
        this.plugOut = plugOut;
        this.newPlugLetter = newPlugLetter;
    }
    var plugData = new plugData(letter,plug[0],lettindex);
    console.warn("plug configuration")
    console.table([plugData]);
    // --------------------------------- END OF DATA LOGS ------------------------------------------------
})